var ne=Object.defineProperty,re=Object.defineProperties;var se=Object.getOwnPropertyDescriptors;var G=Object.getOwnPropertySymbols;var oe=Object.prototype.hasOwnProperty,ce=Object.prototype.propertyIsEnumerable;var B=(e,t,r)=>t in e?ne(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,g=(e,t)=>{for(var r in t||(t={}))oe.call(t,r)&&B(e,r,t[r]);if(G)for(var r of G(t))ce.call(t,r)&&B(e,r,t[r]);return e},p=(e,t)=>re(e,se(t));import{i as le,a as ie,c as de,u as ue,b as me,j as a,C as Ee,d as f,e as l,T as x,r as T,P as he,A as ge,f as pe,L as fe,g as Te,E as Ne,h as Ae,R as y,k as xe,X as Ce,l as Se,m as ye,n as Ie}from"./vendor.c34b3ef6.js";const _e=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const d of o.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&s(d)}).observe(document,{childList:!0,subtree:!0});function r(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerpolicy&&(o.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?o.credentials="include":n.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(n){if(n.ep)return;n.ep=!0;const o=r(n);fetch(n.href,o)}};_e();const be="EkoArgia",Re={EXTREME_EXPENSIVE:"Ordurik garestiena",EXTREME_CHEAP:"Ordurik merkeena",MEAN_PRICE:"Erdi prezioa"},Le={TITLE:"Konfigurazioa",SELECT_LOCATION:"Zure kokapena",SELECT_LANGUAGE:"Aplikazioaren hizkuntza",SELECT_TIME_FORMAT:"Denbora-formatua"},Oe={PENINSULA_CANARIAS_BALEARES:"Penintsula Kanariarak eta Balearak",CEUTA_MELILLA:"Ceuta eta Melilla"},Pe={BY_HOUR:"Ordua arabera",BY_PRICE:"Prezioaren arabera"};var ve={APP_NAME:be,TEXT:Re,SETTINGS:Le,LOCATION:Oe,SORT:Pe};const we="EcoLlum",Me={EXTREME_EXPENSIVE:"L'hora m\xE9s cara",EXTREME_CHEAP:"L'hora m\xE9s barata",MEAN_PRICE:"Preu mitj\xE0"},De={TITLE:"Configuraci\xF3",SELECT_LOCATION:"La teva ubicaci\xF3",SELECT_LANGUAGE:"Idioma de l'aplicaci\xF3",SELECT_TIME_FORMAT:"Format horari"},ke={PENINSULA_CANARIAS_BALEARES:"Pen\xEDnsula Canaries i Balears",CEUTA_MELILLA:"Ceuta i Melilla"},Fe={BY_HOUR:"Per hora",BY_PRICE:"Per preu"};var Ge={APP_NAME:we,TEXT:Me,SETTINGS:De,LOCATION:ke,SORT:Fe};const Be="EcoLuz",Ue={EXTREME_EXPENSIVE:"La hora m\xE1s cara",EXTREME_CHEAP:"La hora m\xE1s barata",MEAN_PRICE:"Precio medio"},He={TITLE:"Configuraci\xF3n",SELECT_LOCATION:"Tu ubicaci\xF3n",SELECT_LANGUAGE:"Idioma de la aplicaci\xF3n",SELECT_TIME_FORMAT:"Formato horario"},$e={PENINSULA_CANARIAS_BALEARES:"Pen\xEDnsula Canarias y Baleares",CEUTA_MELILLA:" Ceuta y Melilla"},Xe={BY_HOUR:"Por hora",BY_PRICE:" Por precio"};var Ye={APP_NAME:Be,TEXT:Ue,SETTINGS:He,LOCATION:$e,SORT:Xe};const ze="EcoLuz",je={EXTREME_EXPENSIVE:"A hora m\xE1is cara",EXTREME_CHEAP:"A hora m\xE1is barata",MEAN_PRICE:"Medio prezo"},We={TITLE:"Configuraci\xF3n",SELECT_LOCATION:"A s\xFAa localizaci\xF3n",SELECT_LANGUAGE:"Idioma da aplicaci\xF3n",SELECT_TIME_FORMAT:"Formato horario"},Ve={PENINSULA_CANARIAS_BALEARES:"Pen\xEDnsula Canarias e Baleares",CEUTA_MELILLA:"Ceuta e Melilla"},Ke={BY_HOUR:"Por hora",BY_PRICE:"Por prezo"};var Je={APP_NAME:ze,TEXT:je,SETTINGS:We,LOCATION:Ve,SORT:Ke};const qe={ba:{translation:ve},ca:{translation:Ge},es:{translation:Ye},ga:{translation:Je}};le.use(ie).init({resources:qe,fallbackLng:"es",debug:!0,interpolation:{escapeValue:!1}});const U="SET_LANGUAGE",H="SET_LOCATION",$="SET_TIME_FORMAT",X="TOGGLE_SETTINGS_DRAWER",Y="LOAD_SAVED_SETTINGS";function Ze(e){return localStorage.setItem("@location",e),{type:H,locationCode:e}}function Qe(e){return localStorage.setItem("@language",e),{type:U,languageCode:e}}function et(e){return localStorage.setItem("@timeFormat",e),{type:$,timeFormat:e}}function b(){return{type:X}}function tt(){const e=localStorage.getItem("@language"),t=localStorage.getItem("@location"),r=localStorage.getItem("@timeFormat");return{type:Y,languageCode:e,locationCode:t,timeFormat:r}}const z="UPDATE_PRICES_DATA",j="UPDATE_CURRENT_HOUR",W="UPDATE_CURRENT_DAY";function V(e){return{type:z,priceSlots:e}}function at(e){return{type:j,currentHour:e}}function nt(e){return{type:W,currentDay:e}}const rt={slots:[],currentHour:new Date().getHours(),currentDay:new Date().getDate()},st=(e=rt,t)=>{switch(t.type){case z:return p(g({},e),{slots:t.priceSlots});case j:return p(g({},e),{currentHour:t.currentHour});case W:return p(g({},e),{currentDay:t.currentDay});default:return e}};var R;(function(e){e.PCB="PCB",e.CYM="CYM"})(R||(R={}));var L;(function(e){e.ba="ba",e.ca="ca",e.es="es",e.ga="ga"})(L||(L={}));var O;(function(e){e["24h"]="24h",e["12h"]="12h"})(O||(O={}));var C;(function(e){e.Red="red",e.Yellow="yellow",e.Green="green"})(C||(C={}));function P(...e){return e.filter(Boolean).join(" ")}const K={location:R.PCB,language:L.es,timeFormat:O["24h"],settingsOpen:!1},v=(e,t)=>e===null?K[t]:e,ot=(e=K,t)=>{switch(t.type){case H:return p(g({},e),{location:t.locationCode});case U:return p(g({},e),{language:t.languageCode});case $:return p(g({},e),{timeFormat:t.timeFormat});case X:return p(g({},e),{settingsOpen:!e.settingsOpen});case Y:return p(g({},e),{language:v(t.languageCode,"language"),location:v(t.locationCode,"location"),timeFormat:v(t.timeFormat,"timeFormat")});default:return e}},J=de({reducer:{rates:st,settings:ot}});J.dispatch(tt());const S=()=>ue(),h=me,ct=()=>{const e=S();return a("a",{children:a(Ee,{onClick:()=>e(b()),className:"w-8 h-8 text-white cursor-pointer"})})},lt=()=>{const{t:e}=f("translation");return l("nav",{className:"fixed z-20 flex items-center justify-between w-full p-3 bg-teal-500",children:[a("a",{href:"https://josepdecid.me/ecoluz/",children:l("div",{className:"flex items-center flex-shrink-0 mr-6 text-white",children:[a("img",{src:"/ecoluz/favicon.ico",alt:`${e("APP_NAME")} logo`,className:"w-10 h-10 mr-1"}),a("span",{className:"text-2xl font-bold",children:e("APP_NAME")})]})}),a("div",{className:"lg:flex lg:items-center lg:w-auto",children:a(ct,{})})]})},q=({tabs:e})=>a("div",{className:"shadow-2xl rounded-xl",children:l(x.Group,{children:[a(x.List,{className:"flex p-2 space-x-1 bg-teal-500 rounded-t-xl",children:e.map(({title:t,key:r})=>a(x,{className:({selected:s})=>P("w-full py-2.5 text-sm leading-5 font-medium text-white rounded-lg",s?"bg-white shadow text-teal-500":"text-teal-300 hover:bg-white-100 hover:text-white"),children:t},r))}),a(x.Panels,{className:"mt-2",children:e.map(({key:t,content:r})=>a(x.Panel,{className:P("bg-white rounded-xl p-3","focus:outline-none focus:ring-2 ring-offset-2 ring-offset-blue-400 ring-white ring-opacity-60"),children:r},t))})]})}),I=(e,t,r="24h")=>{e%=24;const s=t<10?"0":"";if(r==="24h")return(e<10?"0":"")+e+(t>=0?":"+s+t:"h");{const n=e<12?"am":"pm";return e%=12,e==0&&(e=12),(e<10?"0":"")+e+(t>=0?":"+s+t+n:"h")}},w=e=>e<8?C.Green:e<16?C.Yellow:C.Red;let M=null;const Z=()=>{const e=S(),t=h(({rates:u,settings:E})=>({hourlyRates:u.slots,currentHour:u.currentHour,currentDay:u.currentDay,locationCode:E.location,timeFormat:E.timeFormat})),r=[...t.hourlyRates].sort((u,E)=>u.price[t.locationCode]>E.price[t.locationCode]?1:-1),s=()=>{const u=new Date;return I(u.getHours(),u.getMinutes(),t.timeFormat)},n=()=>{const u=new Date;return r.find(E=>E.hour===u.getHours())},[o,d]=T.exports.useState(s()),[i,c]=T.exports.useState(n());T.exports.useEffect(()=>{M!==null&&clearInterval(M),M=setInterval(()=>{d(s()),c(n());const u=new Date,E=u.getHours();E!==t.currentHour&&e(at(E));const N=u.getDate();N!==t.currentDay&&e(nt(N))},1e3)},[t]);const m=w(r.indexOf(i));return l("div",{className:`p-6 rounded-lg shadow-2xl md:shadow-xl bg-${m}-500`,children:[a("div",{className:"float-left p-4 bg-white border border-white rounded-lg w-max",children:a("span",{className:"text-2xl font-bold lg:text-4xl",children:o})}),l("div",{className:"p-4 mt-4 text-right bg-white border border-white rounded-lg",children:[a("span",{className:"text-5xl font-bold md:text-6xl",children:i.price[t.locationCode].toFixed(4)}),a("span",{className:"text-lg align-right",children:"\u20AC/kWh"})]})]})},_=({extreme:e})=>{const{t}=f(),r=h(({rates:i})=>i.slots),s=h(({settings:i})=>({location:i.location,timeFormat:i.timeFormat})),n=r.reduce((i,c)=>e==="max"?i.price[s.location]>c.price[s.location]?i:c:i.price[s.location]>c.price[s.location]?c:i,r[0]);let o,d;return e==="max"?(o="text-red-500",d="TEXT.EXTREME_EXPENSIVE"):(o="text-green-500",d="TEXT.EXTREME_CHEAP"),l("div",{className:"space-y-2 text-center divide-y divide-gray divide-opacity-50",children:[l("span",{className:"pb-2 text-lg font-bold uppercase",children:[t(d),":"]}),l("div",{className:"pt-6",children:[l("div",{className:`mb-1 ${o}`,children:[a("span",{className:"text-4xl font-bold",children:n.price[s.location].toFixed(4)}),a("span",{className:"text-lg",children:"\u20AC/kWh"})]}),l("span",{className:"text-3xl font-bold text-teal-500",children:[I(n.hour,-1,s.timeFormat),"\xA0-\xA0",I(n.hour+1,-1,s.timeFormat)]})]})]})},Q=()=>{const{t:e}=f(),t=h(({rates:o})=>o.slots),r=h(({settings:o})=>({location:o.location,timeFormat:o.timeFormat})),n=t.reduce((o,d)=>o+d.price[r.location],0)/t.length;return l("div",{className:"space-y-2 text-center divide-y divide-gray divide-opacity-50",children:[l("span",{className:"pb-2 text-lg font-bold uppercase",children:[e("TEXT.MEAN_PRICE"),":"]}),a("div",{className:"pt-6",children:l("div",{className:"text-teal-500",children:[a("span",{className:"text-4xl font-bold",children:n.toFixed(4)}),a("span",{className:"text-lg",children:"\u20AC/kWh"})]})})]})},it=()=>l("div",{className:"px-4",children:[l("div",{className:"md:hidden",children:[a(Z,{}),a("div",{className:"mt-4",children:a(q,{tabs:[{key:"mean",title:a(he,{className:"w-8 h-8 mx-auto"}),content:a(Q,{})},{key:"min",title:a(ge,{className:"w-8 h-8 mx-auto"}),content:a(_,{extreme:"min"})},{key:"max",title:a(pe,{className:"w-8 h-8 mx-auto"}),content:a(_,{extreme:"max"})}]})})]}),l("div",{className:"items-center hidden md:block lg:flex",children:[a(Z,{}),l("div",{className:"flex justify-center flex-1 space-x-12 lg:justify-start lg:ml-12 md:mt-6 md:mb-12",children:[a(Q,{}),a(_,{extreme:"min"}),a(_,{extreme:"max"})]})]})]}),ee=()=>{const e=h(({rates:c,settings:m})=>({hourlyRates:c.slots,locationCode:m.location})),t=Array.from(Array(24).keys()),r=e.hourlyRates.map(c=>c.price[e.locationCode]),s={red:{500:"#ff4c30"},yellow:{500:"#fde69c"},green:{500:"#70ad46"}},n=[...e.hourlyRates].sort((c,m)=>c.price[e.locationCode]>m.price[e.locationCode]?1:-1),o=e.hourlyRates.map(c=>{const m=w(n.indexOf(c));return s[m][500]});return a(fe,{data:{labels:t,datasets:[{data:r,fill:!1,backgroundColor:o,borderColor:"black",tension:.2}]},options:{scales:{x:{ticks:{callback:function(c){return(c<10?"0":"")+c.toString()+"h"}}},y:{title:{display:!0,text:"\u20AC/kWh"}}},plugins:{legend:{display:!1},tooltip:{enabled:!1}}}})},D=({rates:e,thresholds:t})=>{const r=h(({settings:n})=>n.timeFormat),s=h(({rates:n})=>n.currentHour);return l("div",{children:[e.map(({hour:n,price:o,color:d})=>{const i=o>=t.max,c=o<=t.min,m=n===s;return a("div",{className:P("py-0.5 pr-3 m-0.5 bg-red-500 rounded-md",m?"border-4 border-black":"",i?"border-2 border-red-700":"",c?"border-2 border-green-700":"",s>n?"opacity-30":"",d==="red"?"bg-red-500":d==="yellow"?"bg-yellow-500":"bg-green-500"),children:l("div",{className:"flex justify-between px-2 align-center",children:[l("div",{className:"flex items-center flex-shrink-0 rounded-md",children:[a("span",{className:"px-1 text-xl font-bold",children:I(n,0,r)}),l("div",{className:"w-6 mx-0.5 text-black",children:[c&&a(Te,{className:"w-18 h-18"}),i&&a(Ne,{className:"w-18 h-18"})]})]}),l("div",{className:"flex-between align-end",children:[a("span",{className:`text-lg flex-start ${m?"text-bold":""}`,children:o.toFixed(4)}),a("span",{className:m?"text-bold":"",children:"\xA0\u20AC/kWh"})]})]})},n)}),a("div",{className:"mt-5 md:hidden",children:a(ee,{})})]})},te=(e,t,r)=>l("div",{className:"flex-1 p-3 space-y-2 text-center ",children:[l("div",{className:"sticky z-10 w-full p-4 text-lg font-bold uppercase bg-white rounded-b-lg shadow-sm top-16",children:[e,":"]}),a(D,{rates:t,thresholds:r})]}),dt=()=>{const{t:e}=f(),t=h(({rates:i,settings:c})=>({hourlyRates:i.slots,locationCode:c.location}));let s=[...t.hourlyRates.map(({hour:i,price:c})=>({hour:i,price:c[t.locationCode]}))].sort((i,c)=>i.price>c.price?1:-1);const n=s.map(i=>{const c=w(s.indexOf(i));return p(g({},i),{color:c})}),o=[...n].sort((i,c)=>i.hour>c.hour?1:-1),d={min:s[2].price,max:s[s.length-3].price};return l("div",{className:"px-4",children:[a("div",{className:"mt-4 md:hidden",children:a(q,{tabs:[{key:"hours",title:a("span",{children:e("SORT.BY_HOUR")}),content:a(D,{rates:o,thresholds:d})},{key:"prices",title:a("span",{children:e("SORT.BY_PRICE")}),content:a(D,{rates:n,thresholds:d})}]})}),l("div",{className:"self-start hidden mx-auto mt-4 md:block lg:flex",children:[l("div",{className:"flex flex-1",children:[te(e("SORT.BY_HOUR"),o,d),te(e("SORT.BY_PRICE"),n,d)]}),a("div",{className:"sticky mt-4 top-16",children:a(ee,{})})]})]})},ut=()=>{const[e,t]=T.exports.useState(!1),r=S(),s=h(({rates:n})=>n.currentDay);return T.exports.useEffect(()=>{const n=new Date,o=n.getDate(),d=o<10?"0":"",i=n.getMonth()+1,c=i<10?"0":"",m=n.getFullYear(),u="https://raw.githubusercontent.com/josepdecid/ecoluz/main/data/processed",E=`${d}${o}_${c}${i}_${m}`,N=`${u}/${E}.json`,ae=localStorage.getItem("ratesDay");if(E===ae){console.log("Rates for today fetched previously. Not necessary to download the data again.");const A=JSON.parse(localStorage.getItem("rates"));r(V(A)),t(!0)}else console.log("Rates are not stored locally, downloading from "+N),Ae.get(N).then(A=>{const F=A.data;localStorage.setItem("rates",JSON.stringify(F)),localStorage.setItem("ratesDay",E),r(V(F)),t(!0)}).catch(A=>{console.log(A)})},[s]),e?l("div",{className:"w-screen pt-20 pb-4",children:[a(it,{}),a(dt,{})]}):a("span",{className:"animate-spin",children:"Loading"})},mt=function({children:t,isOpen:r,setIsOpen:s}){const n=()=>s(!1);let o="fixed overflow-hidden z-10 bg-gray-900 bg-opacity-25 inset-0 transform ease-in-out";o+=r?" transition-opacity opacity-100 duration-500 translate-x-0":" transition-all delay-500 opacity-0 translate-x-full";let d="w-screen max-w-lg right-0 absolute bg-white h-full shadow-2xl delay-400 duration-500 ease-in-out transition-all transform";return d+=r?" translate-x-0":" translate-x-full",l("div",{className:o,children:[a("div",{className:d,children:a("div",{className:"relative flex flex-col w-screen h-full max-w-lg pb-10 space-y-6 overflow-y-scroll",children:t})}),a("div",{className:"w-screen h-full cursor-pointer",onClick:n})]})},Et=[{name:"Castellano",code:"es"},{name:"Catal\xE0",code:"ca"},{name:"Euskara",code:"ba"},{name:"Galego",code:"ga"}],ht=[{name:"LOCATION.PENINSULA_CANARIAS_BALEARES",code:"PCB"},{name:"LOCATION.CEUTA_MELILLA",code:"CYM"}],gt=[{name:"24h (11:07pm)",code:"24h"},{name:"12h (23:07)",code:"12h"}],k=({title:e,translate:t,items:r,value:s,onChange:n})=>{const{t:o}=f();return l(y,{value:s,onChange:n,children:[a(y.Label,{children:o(e)}),a("div",{className:"space-y-2",children:r.map(({name:d,code:i})=>a(y.Option,{value:i,className:({checked:c})=>`${c?"bg-teal-500 bg-opacity-75 text-white":"bg-white"}
                            relative rounded-lg shadow-md px-5 py-4 cursor-pointer flex focus:outline-none`,children:({checked:c})=>l("div",{className:"flex items-center justify-between w-full",children:[a("div",{className:"flex items-center",children:a("div",{className:"text-sm",children:a(y.Label,{as:"p",className:`font-medium  ${c?"text-white":"text-gray-900"}`,children:t?o(d):d})})}),c&&a("div",{className:"flex-shrink-0 text-white bg-teal-400",children:a(xe,{className:"w-6 h-6"})})]})},i))})]})},pt=()=>{const{t:e}=f("translation"),t=S(),r=h(({settings:s})=>({location:s.location,language:s.language,timeFormat:s.timeFormat}));return l("div",{children:[l("div",{className:"fixed z-10 flex items-center justify-between w-full px-5 py-4 bg-teal-500 shadow-2xl",children:[a("span",{className:"text-2xl font-bold text-white",children:e("SETTINGS.TITLE")}),a(Ce,{className:"w-8 h-8 ml-2 text-white cursor-pointer",onClick:()=>t(b())})]}),l("div",{className:"mx-4 mt-20 divide-y-2",children:[a("div",{className:"py-4",children:a(k,{title:"SETTINGS.SELECT_LOCATION",translate:!0,items:ht,value:r.location,onChange:s=>t(Ze(s))})}),a("div",{className:"py-4",children:a(k,{title:"SETTINGS.SELECT_LANGUAGE",translate:!0,items:Et,value:r.language,onChange:s=>t(Qe(s))})}),a("div",{className:"py-4",children:a(k,{title:"SETTINGS.SELECT_TIME_FORMAT",items:gt,value:r.timeFormat,onChange:s=>t(et(s))})})]})]})},ft=()=>{const{i18n:e}=f(),t=S(),r=h(({settings:n})=>({settingsOpen:n.settingsOpen,language:n.language}));T.exports.useEffect(()=>{e.changeLanguage(r.language)},[r.language]);const s=r.settingsOpen?"filter blur-sm":"";return l("div",{children:[l("div",{className:s,children:[a(lt,{}),a(ut,{})]}),a(mt,{isOpen:r.settingsOpen,setIsOpen:()=>t(b()),children:a(pt,{})})]})};Se.render(a(ye.StrictMode,{children:a(Ie,{store:J,children:a(ft,{})})}),document.getElementById("root"));
