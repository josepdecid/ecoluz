var ae=Object.defineProperty,ne=Object.defineProperties;var re=Object.getOwnPropertyDescriptors;var G=Object.getOwnPropertySymbols;var se=Object.prototype.hasOwnProperty,oe=Object.prototype.propertyIsEnumerable;var B=(e,a,r)=>a in e?ae(e,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[a]=r,g=(e,a)=>{for(var r in a||(a={}))se.call(a,r)&&B(e,r,a[r]);if(G)for(var r of G(a))oe.call(a,r)&&B(e,r,a[r]);return e},p=(e,a)=>ne(e,re(a));import{i as ce,a as le,c as ie,u as de,b as ue,j as t,C as me,d as f,e as c,T as A,r as T,P as Ee,A as he,f as ge,L as pe,g as fe,E as Te,h as Ne,R as y,k as xe,X as Ae,l as Ce,m as Se,n as ye}from"./vendor.816f660d.js";const Ie=function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function r(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerpolicy&&(o.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?o.credentials="include":n.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(n){if(n.ep)return;n.ep=!0;const o=r(n);fetch(n.href,o)}};Ie();const _e="EkoArgia",Re={EXTREME_EXPENSIVE:"Ordurik garestiena",EXTREME_CHEAP:"Ordurik merkeena",MEAN_PRICE:"Erdi prezioa"},be={TITLE:"Konfigurazioa",SELECT_LOCATION:"Zure kokapena",SELECT_LANGUAGE:"Aplikazioaren hizkuntza",SELECT_TIME_FORMAT:"Denbora-formatua"},Le={PENINSULA_CANARIAS_BALEARES:"Penintsula Kanariarak eta Balearak",CEUTA_MELILLA:"Ceuta eta Melilla"},ve={BY_HOUR:"Ordua arabera",BY_PRICE:"Prezioaren arabera"};var Oe={APP_NAME:_e,TEXT:Re,SETTINGS:be,LOCATION:Le,SORT:ve};const Pe="EcoLlum",we={EXTREME_EXPENSIVE:"L'hora m\xE9s cara",EXTREME_CHEAP:"L'hora m\xE9s barata",MEAN_PRICE:"Preu mitj\xE0"},Me={TITLE:"Configuraci\xF3",SELECT_LOCATION:"La teva ubicaci\xF3",SELECT_LANGUAGE:"Idioma de l'aplicaci\xF3",SELECT_TIME_FORMAT:"Format horari"},De={PENINSULA_CANARIAS_BALEARES:"Pen\xEDnsula Canaries i Balears",CEUTA_MELILLA:"Ceuta i Melilla"},Fe={BY_HOUR:"Per hora",BY_PRICE:"Per preu"};var ke={APP_NAME:Pe,TEXT:we,SETTINGS:Me,LOCATION:De,SORT:Fe};const Ge="EcoLuz",Be={EXTREME_EXPENSIVE:"La hora m\xE1s cara",EXTREME_CHEAP:"La hora m\xE1s barata",MEAN_PRICE:"Precio medio"},Ue={TITLE:"Configuraci\xF3n",SELECT_LOCATION:"Tu ubicaci\xF3n",SELECT_LANGUAGE:"Idioma de la aplicaci\xF3n",SELECT_TIME_FORMAT:"Formato horario"},He={PENINSULA_CANARIAS_BALEARES:"Pen\xEDnsula Canarias y Baleares",CEUTA_MELILLA:" Ceuta y Melilla"},$e={BY_HOUR:"Por hora",BY_PRICE:" Por precio"};var Xe={APP_NAME:Ge,TEXT:Be,SETTINGS:Ue,LOCATION:He,SORT:$e};const Ye="EcoLuz",ze={EXTREME_EXPENSIVE:"A hora m\xE1is cara",EXTREME_CHEAP:"A hora m\xE1is barata",MEAN_PRICE:"Medio prezo"},je={TITLE:"Configuraci\xF3n",SELECT_LOCATION:"A s\xFAa localizaci\xF3n",SELECT_LANGUAGE:"Idioma da aplicaci\xF3n",SELECT_TIME_FORMAT:"Formato horario"},Ve={PENINSULA_CANARIAS_BALEARES:"Pen\xEDnsula Canarias e Baleares",CEUTA_MELILLA:"Ceuta e Melilla"},We={BY_HOUR:"Por hora",BY_PRICE:"Por prezo"};var Ke={APP_NAME:Ye,TEXT:ze,SETTINGS:je,LOCATION:Ve,SORT:We};const Je={ba:{translation:Oe},ca:{translation:ke},es:{translation:Xe},ga:{translation:Ke}};ce.use(le).init({resources:Je,fallbackLng:"es",debug:!0,interpolation:{escapeValue:!1}});const U="SET_LANGUAGE",H="SET_LOCATION",$="SET_TIME_FORMAT",X="TOGGLE_SETTINGS_DRAWER",Y="LOAD_SAVED_SETTINGS";function qe(e){return localStorage.setItem("@location",e),{type:H,locationCode:e}}function Ze(e){return localStorage.setItem("@language",e),{type:U,languageCode:e}}function Qe(e){return localStorage.setItem("@timeFormat",e),{type:$,timeFormat:e}}function R(){return{type:X}}function et(){const e=localStorage.getItem("@language"),a=localStorage.getItem("@location"),r=localStorage.getItem("@timeFormat");return{type:Y,languageCode:e,locationCode:a,timeFormat:r}}const z="UPDATE_PRICES_DATA",j="UPDATE_CURRENT_HOUR",V="UPDATE_CURRENT_DAY";function W(e){return{type:z,priceSlots:e}}function tt(e){return{type:j,currentHour:e}}function at(e){return{type:V,currentDay:e}}const nt={slots:[],currentHour:new Date().getHours(),currentDay:new Date().getDate()},rt=(e=nt,a)=>{switch(a.type){case z:return p(g({},e),{slots:a.priceSlots});case j:return p(g({},e),{currentHour:a.currentHour});case V:return p(g({},e),{currentDay:a.currentDay});default:return e}};var b;(function(e){e.PCB="PCB",e.CYM="CYM"})(b||(b={}));var L;(function(e){e.ba="ba",e.ca="ca",e.es="es",e.ga="ga"})(L||(L={}));var v;(function(e){e["24h"]="24h",e["12h"]="12h"})(v||(v={}));var C;(function(e){e.Red="red",e.Yellow="yellow",e.Green="green"})(C||(C={}));function O(...e){return e.filter(Boolean).join(" ")}const K={location:b.PCB,language:L.es,timeFormat:v["24h"],settingsOpen:!1},P=(e,a)=>e===null?K[a]:e,st=(e=K,a)=>{switch(a.type){case H:return p(g({},e),{location:a.locationCode});case U:return p(g({},e),{language:a.languageCode});case $:return p(g({},e),{timeFormat:a.timeFormat});case X:return p(g({},e),{settingsOpen:!e.settingsOpen});case Y:return p(g({},e),{language:P(a.languageCode,"language"),location:P(a.locationCode,"location"),timeFormat:P(a.timeFormat,"timeFormat")});default:return e}},J=ie({reducer:{rates:rt,settings:st}});J.dispatch(et());const S=()=>de(),h=ue;function ot(){const e=S();return t("a",{children:t(me,{onClick:()=>e(R()),className:"w-8 h-8 text-white cursor-pointer"})})}function ct(){const{t:e}=f("translation");return c("nav",{className:"fixed z-10 flex items-center justify-between w-full p-3 bg-teal-500",children:[c("div",{className:"flex items-center flex-shrink-0 mr-6 text-white",children:[t("img",{src:"/ecoluz/favicon.ico",alt:`${e("APP_NAME")} logo`,className:"w-10 h-10 mr-1"}),t("span",{className:"text-2xl font-bold",children:e("APP_NAME")})]}),t("div",{className:"lg:flex lg:items-center lg:w-auto",children:t(ot,{})})]})}function q(e){const{tabs:a}=e;return t("div",{className:"shadow-2xl rounded-xl",children:c(A.Group,{children:[t(A.List,{className:"flex p-2 space-x-1 bg-teal-500 rounded-t-xl",children:a.map(({title:r,key:s})=>t(A,{className:({selected:n})=>O("w-full py-2.5 text-sm leading-5 font-medium text-white rounded-lg",n?"bg-white shadow text-teal-500":"text-teal-300 hover:bg-white-100 hover:text-white"),children:r},s))}),t(A.Panels,{className:"mt-2",children:a.map(({key:r,content:s})=>t(A.Panel,{className:O("bg-white rounded-xl p-3","focus:outline-none focus:ring-2 ring-offset-2 ring-offset-blue-400 ring-white ring-opacity-60"),children:s},r))})]})})}const I=(e,a,r="24h")=>{e%=24;const s=a<10?"0":"";if(r==="24h")return(e<10?"0":"")+e+(a>=0?":"+s+a:"h");{const n=e<12?"am":"pm";return e%=12,e==0&&(e=12),(e<10?"0":"")+e+(a>=0?":"+s+a+n:"h")}},w=e=>e<8?C.Green:e<16?C.Yellow:C.Red;let M=null;function lt(){const e=S(),a=h(({rates:u,settings:E})=>({hourlyRates:u.slots,currentHour:u.currentHour,currentDay:u.currentDay,locationCode:E.location,timeFormat:E.timeFormat})),r=[...a.hourlyRates].sort((u,E)=>u.price[a.locationCode]>E.price[a.locationCode]?1:-1),s=()=>{const u=new Date;return I(u.getHours(),u.getMinutes(),a.timeFormat)},n=()=>{const u=new Date;return r.find(E=>E.hour===u.getHours())},[o,l]=T.exports.useState(s()),[d,i]=T.exports.useState(n());T.exports.useEffect(()=>{M!==null&&clearInterval(M),M=setInterval(()=>{l(s()),i(n());const u=new Date,E=u.getHours();E!==a.currentHour&&e(tt(E));const N=u.getDate();N!==a.currentDay&&e(at(N))},1e3)},[a]);const m=w(r.indexOf(d));return c("div",{className:`p-6 rounded-lg shadow-2xl md:shadow-xl bg-${m}-500`,children:[t("div",{className:"float-left p-4 bg-white border border-white rounded-lg w-max",children:t("span",{className:"text-2xl font-bold lg:text-4xl",children:o})}),c("div",{className:"p-4 mt-4 text-right bg-white border border-white rounded-lg",children:[t("span",{className:"text-5xl font-bold md:text-6xl",children:d.price[a.locationCode].toFixed(4)}),t("span",{className:"text-lg align-right",children:"\u20AC/kWh"})]})]})}function _(e){const{extreme:a}=e,{t:r}=f(),s=h(({rates:i})=>i.slots),n=h(({settings:i})=>({location:i.location,timeFormat:i.timeFormat})),o=s.reduce((i,m)=>a==="max"?i.price[n.location]>m.price[n.location]?i:m:i.price[n.location]>m.price[n.location]?m:i,s[0]);let l,d;return a==="max"?(l="text-red-500",d="TEXT.EXTREME_EXPENSIVE"):(l="text-green-500",d="TEXT.EXTREME_CHEAP"),c("div",{className:"space-y-2 text-center divide-y divide-gray divide-opacity-50",children:[c("span",{className:"pb-2 text-lg font-bold uppercase",children:[r(d),":"]}),c("div",{className:"pt-6",children:[c("div",{className:`mb-1 ${l}`,children:[t("span",{className:"text-4xl font-bold",children:o.price[n.location].toFixed(4)}),t("span",{className:"text-lg",children:"\u20AC/kWh"})]}),c("span",{className:"text-3xl font-bold text-teal-500",children:[I(o.hour,-1,n.timeFormat),"\xA0-\xA0",I(o.hour+1,-1,n.timeFormat)]})]})]})}function Z(){const{t:e}=f(),a=h(({rates:o})=>o.slots),r=h(({settings:o})=>({location:o.location,timeFormat:o.timeFormat})),n=a.reduce((o,l)=>o+l.price[r.location],0)/a.length;return c("div",{className:"space-y-2 text-center divide-y divide-gray divide-opacity-50",children:[c("span",{className:"pb-2 text-lg font-bold uppercase",children:[e("TEXT.MEAN_PRICE"),":"]}),t("div",{className:"pt-6",children:c("div",{className:"text-teal-500",children:[t("span",{className:"text-4xl font-bold",children:n.toFixed(4)}),t("span",{className:"text-lg",children:"\u20AC/kWh"})]})})]})}function it(){return c("div",{className:"px-4 bg-white md:pb-5 top-20 md:flex md:space-x-6",children:[t("div",{className:"flex-2",children:t(lt,{})}),t("div",{className:"mt-4 md:hidden",children:t(q,{tabs:[{key:"mean",title:t(Ee,{className:"w-8 h-8 mx-auto"}),content:t(Z,{})},{key:"min",title:t(he,{className:"w-8 h-8 mx-auto"}),content:t(_,{extreme:"min"})},{key:"max",title:t(ge,{className:"w-8 h-8 mx-auto"}),content:t(_,{extreme:"max"})}]})}),c("div",{className:"flex-1 hidden space-x-10 md:flex",children:[t("div",{className:"flex-1 mt-10",children:t(Z,{})}),t("div",{className:"flex-1 mt-10",children:t(_,{extreme:"min"})}),t("div",{className:"flex-1 mt-10",children:t(_,{extreme:"max"})})]})]})}function Q(){const e=h(({rates:i,settings:m})=>({hourlyRates:i.slots,locationCode:m.location})),a=Array.from(Array(24).keys()),r=e.hourlyRates.map(i=>i.price[e.locationCode]),s={red:{500:"#ff4c30"},yellow:{500:"#fde69c"},green:{500:"#70ad46"}},n=[...e.hourlyRates].sort((i,m)=>i.price[e.locationCode]>m.price[e.locationCode]?1:-1),o=e.hourlyRates.map(i=>{const m=w(n.indexOf(i));return s[m][500]});return t(pe,{data:{labels:a,datasets:[{data:r,fill:!1,backgroundColor:o,borderColor:"black",tension:.2}]},options:{scales:{x:{ticks:{callback:function(i,m,u){return(i<10?"0":"")+i.toString()+"h"}}},y:{title:{display:!0,text:"\u20AC/kWh"}}},plugins:{legend:{display:!1},tooltip:{enabled:!1}}}})}function D(e){const{rates:a,thresholds:r}=e,s=h(({settings:o})=>o.timeFormat),n=h(({rates:o})=>o.currentHour);return c("div",{children:[a.map(({hour:o,price:l,color:d})=>{const i=l>=r.max,m=l<=r.min,u=o===n;return t("div",{className:O("py-0.5 pr-3 m-0.5 bg-red-500 rounded-md",u?"border-4 border-black":"",i?"border-2 border-red-700":"",m?"border-2 border-green-700":"",n>o?"opacity-30":"",d==="red"?"bg-red-500":d==="yellow"?"bg-yellow-500":"bg-green-500"),children:c("div",{className:"flex justify-between px-2 align-center",children:[c("div",{className:"flex items-center flex-shrink-0 rounded-md",children:[t("span",{className:"px-1 text-xl font-bold",children:I(o,0,s)}),c("div",{className:"w-6 mx-0.5 text-black",children:[m&&t(fe,{className:"w-18 h-18"}),i&&t(Te,{className:"w-18 h-18"})]})]}),c("div",{className:"flex-between align-end",children:[t("span",{className:`text-lg flex-start ${u?"text-bold":""}`,children:l.toFixed(4)}),t("span",{className:u?"text-bold":"",children:"\xA0\u20AC/kWh"})]})]})},o)}),t("div",{className:"mt-5 md:hidden",children:t(Q,{})})]})}const ee=(e,a,r)=>c("div",{className:"space-y-2 text-center",children:[c("div",{className:"sticky w-full p-4 text-lg font-bold uppercase bg-white top-16",children:[e,":"]}),t(D,{rates:a,thresholds:r})]});function dt(){const{t:e}=f(),a=h(({rates:l,settings:d})=>({hourlyRates:l.slots,locationCode:d.location}));let s=[...a.hourlyRates.map(({hour:l,price:d})=>({hour:l,price:d[a.locationCode]}))].sort((l,d)=>l.price>d.price?1:-1);s=s.map(l=>{const d=w(s.indexOf(l));return p(g({},l),{color:d})});const n=[...s].sort((l,d)=>l.hour>d.hour?1:-1),o={min:s[2].price,max:s[s.length-3].price};return c("div",{className:"px-4",children:[t("div",{className:"mt-4 md:hidden",children:t(q,{tabs:[{key:"hours",title:t("span",{children:e("SORT.BY_HOUR")}),content:t(D,{rates:n,thresholds:o})},{key:"prices",title:t("span",{children:e("SORT.BY_PRICE")}),content:t(D,{rates:s,thresholds:o})}]})}),c("div",{className:"self-start hidden mt-4 md:flex",children:[c("div",{className:"flex flex-1 divide-x divide-gray divide-opacity-50",children:[ee(e("SORT.BY_HOUR"),n,o),ee(e("SORT.BY_PRICE"),s,o)]}),t("div",{className:"flex-grow",children:t("div",{className:"sticky w-3/4 ml-4 top-24",children:t(Q,{})})})]})]})}function ut(){const[e,a]=T.exports.useState(!1),r=S(),s=h(({rates:n})=>n.currentDay);return T.exports.useEffect(()=>{const n=new Date,o=n.getDate(),l=o<10?"0":"",d=n.getMonth()+1,i=d<10?"0":"",m=n.getFullYear(),u="https://raw.githubusercontent.com/josepdecid/ecoluz/main/data/processed",E=`${l}${o}_${i}${d}_${m}`,N=`${u}/${E}.json`,te=localStorage.getItem("ratesDay");if(E===te){console.log("Rates for today fetched previously. Not necessary to download the data again.");const x=JSON.parse(localStorage.getItem("rates"));r(W(x)),a(!0)}else console.log("Rates are not stored locally, downloading from "+N),Ne.get(N).then(x=>{const k=x.data;localStorage.setItem("rates",JSON.stringify(k)),localStorage.setItem("ratesDay",E),r(W(k)),a(!0)}).catch(x=>{console.log(x)})},[s]),e?c("div",{className:"w-screen pt-20 pb-4",children:[t(it,{}),t(dt,{})]}):t("span",{className:"animate-spin",children:"Loading"})}function mt({children:e,isOpen:a,setIsOpen:r}){return c("main",{className:" fixed overflow-hidden z-10 bg-gray-900 bg-opacity-25 inset-0 transform ease-in-out "+(a?" transition-opacity opacity-100 duration-500 translate-x-0  ":" transition-all delay-500 opacity-0 translate-x-full  "),children:[t("section",{className:" w-screen max-w-lg right-0 absolute bg-white h-full shadow-2xl delay-400 duration-500 ease-in-out transition-all transform  "+(a?" translate-x-0 ":" translate-x-full "),children:t("article",{className:"relative flex flex-col w-screen h-full max-w-lg pb-10 space-y-6 overflow-y-scroll",children:e})}),t("section",{className:"w-screen h-full cursor-pointer ",onClick:()=>{r(!1)}})]})}const Et=[{name:"Castellano",code:"es"},{name:"Catal\xE0",code:"ca"},{name:"Euskara",code:"ba"},{name:"Galego",code:"ga"}],ht=[{name:"LOCATION.PENINSULA_CANARIAS_BALEARES",code:"PCB"},{name:"LOCATION.CEUTA_MELILLA",code:"CYM"}],gt=[{name:"24h (11:07pm)",code:"24h"},{name:"12h (23:07)",code:"12h"}];function F(e){const{title:a,translate:r,items:s,value:n,onChange:o}=e,{t:l}=f();return c(y,{value:n,onChange:o,children:[t(y.Label,{children:l(a)}),t("div",{className:"space-y-2",children:s.map(({name:d,code:i})=>t(y.Option,{value:i,className:({active:m,checked:u})=>`${u?"bg-teal-500 bg-opacity-75 text-white":"bg-white"}
                            relative rounded-lg shadow-md px-5 py-4 cursor-pointer flex focus:outline-none`,children:({active:m,checked:u})=>c("div",{className:"flex items-center justify-between w-full",children:[t("div",{className:"flex items-center",children:t("div",{className:"text-sm",children:t(y.Label,{as:"p",className:`font-medium  ${u?"text-white":"text-gray-900"}`,children:r?l(d):d})})}),u&&t("div",{className:"flex-shrink-0 text-white bg-teal-400",children:t(xe,{className:"w-6 h-6"})})]})},i))})]})}function pt(){const{t:e}=f("translation"),a=S(),r=h(({settings:s})=>({location:s.location,language:s.language,timeFormat:s.timeFormat}));return c("div",{children:[c("div",{className:"fixed z-10 flex items-center justify-between w-full px-5 py-4 bg-teal-500 shadow-2xl",children:[t("span",{className:"text-2xl font-bold text-white",children:e("SETTINGS.TITLE")}),t(Ae,{className:"w-8 h-8 ml-2 text-white cursor-pointer",onClick:()=>a(R())})]}),c("div",{className:"mx-4 mt-20 divide-y-2",children:[t("div",{className:"py-4",children:t(F,{title:"SETTINGS.SELECT_LOCATION",translate:!0,items:ht,value:r.location,onChange:s=>a(qe(s))})}),t("div",{className:"py-4",children:t(F,{title:"SETTINGS.SELECT_LANGUAGE",translate:!0,items:Et,value:r.language,onChange:s=>a(Ze(s))})}),t("div",{className:"py-4",children:t(F,{title:"SETTINGS.SELECT_TIME_FORMAT",items:gt,value:r.timeFormat,onChange:s=>a(Qe(s))})})]})]})}function ft(){const{i18n:e}=f(),a=S(),r=h(({settings:n})=>({settingsOpen:n.settingsOpen,language:n.language}));T.exports.useEffect(()=>{e.changeLanguage(r.language)},[r.language]);const s=r.settingsOpen?"filter blur-sm":"";return c("div",{children:[c("div",{className:s,children:[t(ct,{}),t(ut,{})]}),t(mt,{isOpen:r.settingsOpen,setIsOpen:()=>a(R()),children:t(pt,{})})]})}Ce.render(t(Se.StrictMode,{children:t(ye,{store:J,children:t(ft,{})})}),document.getElementById("root"));
